# RobotCtrl_Core - اللوحة الأساسية

![](https://wiki-media-1253965369.cos.ap-guangzhou.myqcloud.com/img/20220527113423.png)

مستودع المشروع: [**linyuxuanlin/RobotCtrl/RobotCtrl_Core**](https://github.com/linyuxuanlin/RobotCtrl/tree/main/RobotCtrl_MultiBoard_Project/RobotCtrl_Core)

معاينة المشروع عبر الإنترنت:

<div class="altium-iframe-viewer">
  <div
    class="altium-ecad-viewer"
    data-project-src="https://github.com/linyuxuanlin/RobotCtrl/raw/main/RobotCtrl_MultiBoard_Project/RobotCtrl_Core_V2.81B.zip"
  ></div>
</div>

ملاحظة: يتم تضمين المشروع في [**RobotCtrl - STM32 通用开发套件**](https://wiki-power.com/ar/RobotCtrl-STM32%E9%80%9A%E7%94%A8%E5%BC%80%E5%8F%91%E5%A5%97%E4%BB%B6).

## تصميم المخطط الأساسي

تتمثل الوظائف الرئيسية لـ RobotCtrl_Core في ما يلي:

- دائرة تحويل الطاقة (5 فولت إلى 3.3 فولت، مع نقاط اختبار)
- نظام الميكروكنترولر الأدنى
  - دائرة الطاقة (تصفية الطاقة، مصدر طاقة تناظري ADC)
  - دائرة الإعادة (زر إعادة خارجي)
  - دائرة الساعة (مذبذب غير نشط HSE)
  - واجهة التنزيل والتصحيح (SW)
  - وضع التشغيل (اختيار التشغيل من ذاكرة التخزين الفلاش الرئيسية)
  - دائرة الطاقة والاتصالات USB (USB-Micro)
- موصل B2B (يخرج جميع IO)
- أجهزة الاستشعار المدمجة

### دائرة الطاقة

يمكن تغذية RobotCtrl_Core بالطاقة من واجهة USB أو موصل B2B بجهد 5 فولت، وتحويله إلى 3.3 فولت لتشغيل النواة الميكروكنترولر والأجهزة المدمجة على اللوحة. تستخدم دائرة تحويل الطاقة LDO (AMS1117-3.3، الحد الأقصى للتيار هو 1A)، وتحتوي على مؤشر ضوئي للطاقة، وتحتوي على نقاط اختبار حاسمة.

يمكن الرجوع إلى مبدأ LDO في المقالة [**电源拓扑 - 线性稳压**](https://wiki-power.com/ar/%E7%94%B5%E6%BA%90%E6%8B%93%E6%89%91-%E7%BA%BF%E6%80%A7%E7%A8%B3%E5%8E%8B) للمزيد من المعلومات.

### نظام الميكروكنترولر الأدنى

تتكون تصميمات نظام الميكروكنترولر الأدنى من عدة أجزاء: الطاقة والإعادة والتنزيل والتصحيح والساعة ووضع التشغيل. يمكن الرجوع إلى المعرفة الأساسية في المقالات [**如何设计一款单片机的最小系统**](https://wiki-power.com/ar/%E5%A6%82%E4%BD%95%E8%AE%BE%E8%AE%A1%E4%B8%80%E6%AC%BE%E5%8D%95%E7%89%87%E6%9C%BA%E7%9A%84%E6%9C%80%E5%B0%8F%E7%B3%BB%E7%BB%9F) و [**STM32F4 硬件开发**](https://wiki-power.com/ar/STM32F4%E7%A1%AC%E4%BB%B6%E5%BC%80%E5%8F%91).

### دائرة الطاقة

تتكون دائرة التصفية من:

- VDD: سعة 10 ميكروفاراد عامة، بالإضافة إلى سعة 100 نانوفاراد من السيراميك لكل دبوس VDD.
- VDDA: سعة 100 نانوفاراد من السيراميك + سعة 1 ميكروفاراد من السيراميك.

سعة VCAP

- يتم توصيل كل منها بالأرضي بسعة 2.2 ميكروفاراد من السيراميك.

### دائرة الإعادة

يتم تمكين مراقب الطاقة، أي PDR_ON عن طريق مقاومة 120 أوم. بالإضافة إلى ذلك، تمت إضافة زر إعادة مع مانع الارتداد الأجهزة.

### دائرة الساعة

تم اختيار مذبذب HSE الخارجي عالي السرعة (HSE) من Murata 8M.

### واجهة التنزيل والتصحيح

تم توصيل واجهة التنزيل والتصحيح مباشرة في هذا التصميم، ولا يلزم استخدام مقاومات pull-up / pull-down الخارجية (لأن STM32 مدمج بها).

### وضع التشغيل

يتم اختيار التشغيل من ذاكرة التخزين الفلاش الرئيسية، أي يتم توصيل BOOT0 بمقاومة 10 كيلو أوم، ويمكن ترك BOOT1 بأي حالة.

### دائرة الطاقة والاتصالات USB (USB-Micro)

يحتوي STM32 على واجهة USB مدمجة، ويمكن تحقيق الاتصال بالـ USB عن طريق استخدام واجهة مباشرة (في شريحة STM32F07ZE هي PA11 و PA12).

تدعم واجهة USB أيضًا وظيفة التغذية الخارجية (VUSB).

## موصل B2B

تستخدم لوحة RobotCtrl_Core للنواة زوجًا من سلسلة 3710 من شركة DFRobot، وتستخدم لوحة RobotCtrl_Func للتوسع زوجًا من F060037G0FR01 (الأنثى) للتوافق. يكفي زوج B2B (120 دبوسًا مشتركة) لتمكين استخدام جميع مداخل ومخارج STM32F407ZE بالكامل، وتحقيق أقصى استفادة من موارد النظام.

يرجى الرجوع إلى [**3710F Terminal Data**](http://www.openedv.com/thread-78182-1-1.html) للحصول على معلومات ذات صلة حول موصل B2B.

## أزرار المستخدم والمؤشرات الضوئية

لتمكين التحقق والتصحيح البسيطين، تحتوي لوحة RobotCtrl_Core على زر مستخدم ومؤشر ضوئي للمستخدم، ويتم تكوين الزر على أنه وضع إدخال GPIO وتفعيل المقاومة الداخلية للمقاومة، ويتم إضافة مكثف MLCC للتخلص من الاهتزاز الأجهزة. يتم تكوين المؤشر الضوئي على أنه وضع إخراج GPIO، ويتم تشغيل الدبوس عندما يكون عاليًا، ويتم توصيل مقاومة في الوسط لتحديد التيار.

يرجى الرجوع إلى المخطط الأساسي للحصول على التفاصيل الدقيقة.

## اختبار الأجهزة

يتطلب اختبار الطاقة توصيل مقبس USB بمصدر طاقة 5 فولت (أو توصيل الطاقة من خلال لوحة التوسع الخارجية عبر موصل B2B)، ويمكن قياس الجهد المقابل في نقطة الاختبار 3.3 فولت. في الاختبار الفعلي، تم الحصول على 3.32 فولت، وتم التحقق من النجاح.

تم اختبار الوظائف عن طريق حرق البرنامج الأولي (تحكم المستخدم في المؤشر الضوئي للمستخدم)، واختبار الطاقة وزر الإعادة وزر المستخدم ومؤشر LED ووظيفة USB. في الاختبار الفعلي، يمكن حرق البرنامج الأولي بنجاح في لوحة النواة الميكانيكية باستخدام ST-Link. يمكن إعادة تعيين النظام بنجاح باستخدام زر الإعادة. في البرنامج الاختباري، يمكن تشغيل مؤشر LED للمستخدم عن طريق الضغط على زر المستخدم. عند التشغيل، يتم تشغيل مؤشر LED للطاقة بشكل طبيعي. تم اختبار وظيفة USB باستخدام برنامج USB الافتراضي الذي يعمل كمنفذ سلسلة افتراضي، ويمكن فتح أداة المنفذ السلسلي (مع أي معدل بت) وإرسال أي حرف، وسيتم إرجاع الحرف نفسه، وتم التحقق من النجاح.

## المراجع والشكر

- [تفسير جيد للمدخل PDR_ON في STM32 (نشر + تحسين)](https://blog.csdn.net/Frankenstien_/article/details/105971841)
- [DFRobot 【STM32-F407 Explorer】 الفصل الخامس والخمسون: تجربة قارئ بطاقات USB (Slave)](https://zhuanlan.zhihu.com/p/136163591)

> عنوان النص: <https://wiki-power.com/>  
> يتم حماية هذا المقال بموجب اتفاقية [CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by/4.0/deed.zh)، يُرجى ذكر المصدر عند إعادة النشر.

> تمت ترجمة هذه المشاركة باستخدام ChatGPT، يرجى [**تزويدنا بتعليقاتكم**](https://github.com/linyuxuanlin/Wiki_MkDocs/issues/new) إذا كانت هناك أي حذف أو إهمال.