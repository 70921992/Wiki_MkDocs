# RobotCtrl - STM32 通用开发套件

![](https://f004.backblazeb2.com/file/wiki-media/img/20220416181125.jpeg)

مستودع المشروع: [**linyuxuanlin/RobotCtrl**](https://github.com/linyuxuanlin/RobotCtrl)

يتضمن RobotCtrl - STM32 通用开发套件 ثلاثة لوحات:

- [**RobotCtrl_Core - لوحة النواة**](https://wiki-power.com/ar/RobotCtrl_Core-%E6%A0%B8%E5%BF%83%E6%9D%BF)
- [**RobotCtrl_Core - لوحة توسيع الأجهزة الطرفية**](https://wiki-power.com/ar/RobotCtrl_Func-%E5%A4%96%E8%AE%BE%E6%8B%93%E5%B1%95%E6%9D%BF)
- [**RobotCtrl_Power - لوحة تزويد الطاقة**](https://wiki-power.com/ar/RobotCtrl_Power-%E7%94%B5%E6%BA%90%E4%BE%9B%E7%94%B5%E6%9D%BF)

## متطلبات التصميم

![](https://f004.backblazeb2.com/file/wiki-media/img/20220527111854.png)

ملاحظة: ما يلي ملخص التصميم ، يرجى الرجوع إلى المقالات ذات الصلة للحصول على المحتوى الكامل.

### فكرة تصميم RobotCtrl_Core

يتضمن تصميم الدائرة الكهربائية للوحة النواة RobotCtrl_Core دائرة كهربائية للتزويد بالطاقة ونظامًا دقيقًا للميكروكنترولر واتصال USB وموصل B2B وأزرار المستخدم والمصابيح الخلفية.

تستخدم دائرة تزويد الطاقة LDO ، ويتميز بسهولة الدائرة الكهربائية وتموج الإخراج الصغير وتكلفة منخفضة ومساحة تصميم صغيرة. بالإضافة إلى السعة المناسبة للتخلص من التشويش ومؤشر الطاقة ، يتم تحويل الجهد الكهربائي 5 فولت المدخل من منفذ USB أو موصل B2B إلى 3.3 فولت (بحد أقصى 1 أمبير).

في تصميم النظام الدقيق ، يتم تغذية الطاقة بجهد 3.3 فولت وتتم إزالة التشويش المناسب. بالإضافة إلى ذلك ، يتم توصيل مصدر الطاقة المخصص لـ ADC VDDA بـ VDD عن طريق محبس مغناطيسي بمقاومة 120 أوم وإضافة سعة إزالة التشويش الإضافية. يتم إضافة زر إعادة التعيين الخارجي لدائرة الإعادة التعيين ، ويتم تنشيط النظام عن طريق جعل مدخل NRST منخفضًا. يتم إضافة مخرج ساعة HSE الخارجي عن طريق توصيل مذبذب غير نشط من OSC_IN و OSC_OUT. يتم تحديد وضع التشغيل الافتراضي للتشغيل من ذاكرة التخزين الفلاش المدمجة ، أي BOOT0 منخفض و BOOT1 بأي جهد كهربائي ، ويتم سحب BOOT0 إلى الأرض باستخدام مقاومة 10 كيلو أوم. يتم توصيل دائرة التنزيل والتصحيح مباشرةً بواجهة SW (DIO / CLK).

تم تصميم دائرة الاتصال USB ، ويتميز STM32F4 بجهاز USB خارجي مدمج. يتم استخدام موصل USB Micro الخارجي ، ويتم توصيل مقاومة 10 أوم للتيار المحدود في الخط ، ويتم إضافة تلفزيونات وثنائيات ESD على الخط الإشارة والخط الكهربائي لتلبية متطلبات EMC.

يتم استخدام موصل B2B لتوفير إمدادات الطاقة والاتصالات بين RobotCtrl_Func. في هذا التصميم ، يكفي موصلان B2B لتوصيل جميع IO لمتحكم STM32F407ZE وتعزيز قابلية التوسع في المرحلة اللاحقة.

### فكرة تصميم RobotCtrl_Func

يتضمن تصميم الدائرة الكهربائية للوحة توسيع الأجهزة الطرفية RobotCtrl_Func دائرة كهربائية للاتصال بالسلسلة (RS-232 / TTL) والاتصال بـ CAN والاتصال بالإيثرنت ومستشعر الاتجاه وواجهة الموجات فوق الصوتية وواجهة القياس عن بعد بالأشعة تحت الحمراء (مع عزل الضوء) والجرس وواجهة التنزيل والتصحيح SW وأزرار المستخدم والمصابيح الخلفية وواجهة GPIO العامة والطاقة وموصل B2B وغيرها من الوحدات.

توفر دائرة الاتصال بالسلسلة واجهة مستوى TTL و RS-232. يتم استخدام USART1 و UART5 مباشرةً لواجهة TTL ، بينما يتم استخدام دائرة الاتصال RS-232 لتحويل مستوى TTL للميكروكنترولر إلى مستوى RS-232. لتحسين أداء EMC ، يتم توصيل غلاف موصل DB9 بتلفزيونات ثنائية الاتجاه إلى الأرض ، ويتطلب تحويل مستوى TTL إلى RS-232 مصدر طاقة إضافي للتخلص من التشويش والسعة الذاتية.

يتم بناء دائرة الاتصال بـ CAN على أساس رقاقة استقبال وإرسال CAN ، ويتم نقل الإشارة عبر مستوى الجهد المختلف لـ CAN. يجب إضافة مقاومة 120 أومًا في نهاية الخط الكلي لتوافق المصدر وتقليل انعكاس الإشارة.

يعتمد الاتصال بالإيثرنت على رقاقة PHY الخاصة بالإيثرنت ، ويتم استخدام واجهة RMII للاتصال بالميكروكنترولر ، ويتم نقل الإشارة عبر موصل RJ45 الذي يحتوي على محول عزل مدمج. يتم استخدام مذبذب غير نشط بتردد 25 ميجاهرتز للساعة في دائرة الإيثرنت ، ويتطلب توفير طاقة مستقلة لتقليل التداخل الكهربائي ، ويتم استخدام نفس حل تزويد الطاقة الخطي المنخفض الضغط لدائرة الإيثرنت لتوفير طاقة مستقلة.



واجهة دائرة توصيل أربعة حساسات قياس المسافة بالأشعة تحت الحمراء تستخدم حساسات الأشعة تحت الحمراء بقوة 12 فولت وإشارة (NPN مفتوحة دائمًا) ، لذلك يتم توفير الطاقة من RobotCtrl_Power بقوة 12 فولت وإضافة أربعة رقائق عزل الضوء لنقل إشارة الجهد العالي والجهد المنخفض. يتطلب تصميم دائرة عزل الضوء حساب قيمة المقاومة المحددة لتدفق التيار لضمان الحفاظ على الجهد المحدد في دليل البيانات. تم تصميم وحدة حساسية الموقف باستخدام وحدة MPU6050 وترك واجهة I2C محجوزة للتواصل مع الميكروكنترولر.

### تصميم RobotCtrl_Power

تتكون مخططات تصميم RobotCtrl_Power الأساسية من مدخل طاقة XT60 مزدوج ، ودائرة تحويل 24 فولت إلى 12 فولت ودائرة تحويل 24 فولت إلى 5 فولت ، بالإضافة إلى مفتاح التمكين ومؤشر الطاقة ودوائر الحماية من الانعكاس والفولتية الزائدة.

تستخدم دائرة الإنعكاس MOS للحماية من الانعكاس. في حالة الاتصال العادي بالطاقة ، يتم توصيل MOS ؛ في حالة الانعكاس ، يتم قطعه ، مما يحمي الدائرة. في هذا التصميم ، تم اختيار P-MOS المحلي للحماية من الانعكاس ، وتم استخدام مقاومة التقسيم وثنائي الانحراف الثابت لتأمين الجهد البوابي الإيجابي عند الانحراف الإيجابي. لتحقيق الحماية من الفولتية الزائدة وحماية ESD ، يتم توصيل ثنائيات الصمام الثنائي التلفزيوني الموجه على مدخل الطاقة.

تم اختيار تصميم دائرة تحويل الجهد الثابت 12 فولت / 5 فولت بناءً على حل Buck غير معزول يعتمد على LMR14050. بناءً على مبدأ Buck ومراجعة دليل بيانات رقاقة التحويل الثابت ، تم اختيار قيمة مقاومة التغذية المرتدة وحساب النسبة للحفاظ على الإخراج عند 12 فولت / 5 فولت. عند اختيار نوع الملف الحثي ، يجب ملاحظة أن التيار المشبع الأقصى يجب أن يكون أكبر من التيار المتذبذب ، ويجب ترك مساحة فارغة ؛ يتم اختيار ثنائي الصمام الثنائي الشوتكي لتحقيق التبديل السريع ، ويجب أن تلبي الجهد والتيار أيضًا متطلبات الدائرة. بالإضافة إلى ذلك ، يجب توصيل سعة التفريغ الكبيرة والصغيرة على المدخل والمخرج لتصفية التداخل.

يمكن التحكم في مفتاح التمكين للتحكم في فتح وإغلاق الإخراج الثابت ، ويتم توصيل دبوس التمكين الخاص برقاقة Buck لتحقيق الإخراج الثابت الناعم. يمكن لمؤشر الطاقة إشعار المستخدم بحالة الإخراج الثابت 12 فولت / 5 فولت.

## المراجع والشكر

![](https://f004.backblazeb2.com/file/wiki-media/img/20220416181139.jpeg)

هذا المشروع هو مشروع تخرجي الشخصي ، وواجهت العديد من المشاكل الصغيرة والكبيرة في تصميم ولحام وتصحيح المشروع. بفضل مساعدة المشرف والزملاء والأصدقاء ، تم الانتهاء من المشروع بنجاح وحصلت على شهادة تخرج ممتازة. شكرا لكم! 

> عنوان النص: <https://wiki-power.com/>  
> يتم حماية هذا المقال بموجب اتفاقية [CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by/4.0/deed.zh)، يُرجى ذكر المصدر عند إعادة النشر.

> تمت ترجمة هذه المشاركة باستخدام ChatGPT، يرجى [**تزويدنا بتعليقاتكم**](https://github.com/linyuxuanlin/Wiki_MkDocs/issues/new) إذا كانت هناك أي حذف أو إهمال.