# Protocolo de comunicaci칩n - Ethernet 游뚾

## Referencias y agradecimientos

- [Notas de autoaprendizaje de PHY Ethernet](https://zhuanlan.zhihu.com/p/102296622)
- [[Circuitos] Capa f칤sica PHY de Ethernet](https://zhenhuizhang.tk/post/dian-lu-yi-tai-wang-phy-wu-li-ceng/)

> Direcci칩n original del art칤culo: <https://wiki-power.com/>  
> Este art칤culo est치 protegido por la licencia [CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by/4.0/deed.zh). Si desea reproducirlo, por favor indique la fuente.

## Hardware de Ethernet embebido

El hardware de Ethernet de un sistema embebido est치 compuesto principalmente por estos componentes: controlador MAC, chip PHY, transformador de red y conector RJ45, y algunos sistemas tambi칠n tienen un controlador DMA.

![](https://wiki-media-1253965369.cos.ap-guangzhou.myqcloud.com/img/20220627163525.png)

Por lo general, la CPU/MCU integrar치 el MAC en el chip (el MAC es un circuito digital, y debido a consideraciones de 치rea y arquitectura del chip, generalmente se integra en el chip), por lo que el hardware que se debe dise침ar externamente es el PHY, el transformador y la interfaz. En muchos casos, el transformador de red tambi칠n se integrar치 en el conector RJ45.

### MAC

El MAC (protocolo de subcapa de control de acceso al medio, Media Access Control) se encuentra en la capa de enlace de datos de la estructura OSI de siete capas, y es responsable de controlar y conectar el medio f칤sico. El MAC sigue el est치ndar IEEE-802.3.

![](https://wiki-media-1253965369.cos.ap-guangzhou.myqcloud.com/img/20220627171622.png)

Al enviar datos, el protocolo MAC puede determinar de antemano si se pueden enviar datos. Si se pueden enviar, se agregar치 informaci칩n de control a los datos y luego se enviar치n los datos y la informaci칩n de control en un formato especificado a la capa f칤sica.

Al recibir datos, el protocolo MAC primero verifica si hay errores de transmisi칩n en la informaci칩n de entrada. Si no hay errores, se elimina la informaci칩n de control y se env칤a a la capa LLC.

### PHY

PHY es el transceptor de interfaz f칤sica, y es responsable de implementar la capa f칤sica de Ethernet. PHY est치 definido por el est치ndar IEEE-802.3, que incluye la subcapa de interfaz independiente del medio MII/GMII, la subcapa de codificaci칩n f칤sica PCS, la subcapa de medio f칤sico adjunto PMA, la subcapa relacionada con el medio f칤sico PMD y la subcapa MDI.

Al enviar datos, PHY recibir치 los datos transmitidos desde MAC (para PHY, no hay concepto de trama, para 칠l, todo son datos sin importar la direcci칩n, los datos o el CRC. Para 100BaseTX, debido al uso de codificaci칩n 4B/5B, cada 4 bits aumentar치 un c칩digo de detecci칩n de errores de 1 bit), luego convertir치 los datos paralelos en datos de flujo serie, los codificar치 seg칰n las reglas de codificaci칩n de la capa f칤sica y los convertir치 en se침ales anal칩gicas para enviarlos. El proceso de recepci칩n de datos es el contrario. El diagrama de estructura interna t칤pico de PHY se muestra a continuaci칩n (RTL8211E):

![](https://wiki-media-1253965369.cos.ap-guangzhou.myqcloud.com/img/20220627171548.png)

### Protocolo de interfaz entre MAC y PHY

> Este post est치 traducido usando ChatGPT, por favor [**feedback**](https://github.com/linyuxuanlin/Wiki_MkDocs/issues/new) si hay alguna omisi칩n.
