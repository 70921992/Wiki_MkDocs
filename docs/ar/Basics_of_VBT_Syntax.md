# ุฃุณุงุณูุงุช ุจูุงุก ุฌูู VBT

> ูุฐู ุงูููุงูุฉ ูุชุงุญุฉ ุจุงููุบุฉ ุงูุฅูุฌููุฒูุฉ ููุท.

## ูุงุฆูุงุช ุงูุจูุงูุงุช

### TheHdw ู TheExec

ููุงู ููุงุจุถุงู ุนุงูููุชุงู ูู ูุงุฌูุฉ VBT ูุชุดุบูู ุนุชุงุฏ ุงูุงุฎุชุจุงุฑ:

- **TheHdw (ุงูุนุชุงุฏ)**: ูุฏุนู ุงููุตูู ูุงูุชุญูู ูู ุงูุฃุฏูุงุชุ ููุชุถูู ุงููุฒูุฏ ูู ุงููุธุงุฆู ุงูุนุงูุฉ ููุนุชุงุฏุ ูุซู ุงูุชูุจููุงุช.
- **TheExec (ุงูุชูููุฐู)**: ููุชุญูู ูู ูุธุงุฆู ุจุฑูุงูุฌ ุงูุงุฎุชุจุงุฑ ุงูุนุงูุฉุ ูุซู ุชูููุฐ ุงูุงุฎุชุจุงุฑุ ููุนุงูุฌุฉ ูุชุงุฆุฌ ุงูุงุฎุชุจุงุฑุ ูุชุณุฌูู ุฏูุชุฑ ุงูุจูุงูุงุช.

ูููุง ููู ุฃูุซูุฉ ุนูู ุงุณุชุฎุฏุงููุง:

```vbscript
' ุชุนููู ูุทุงู ุฏุจูุณ p0 ุงูุญุงูู
TheHdw.DCVI.Pins("p0").CurrentRange = 0.002
```

```vbscript
' ุงูุญุตูู ุนูู ูุณุงุฑ ููู STDF ุงูุฅุฎุฑุงุฌ ุงูุญุงูู
CurrStdfFile = TheExec.Datalog.Setup.STDFOutputFile
```

### ูุงุฆูุงุช ุงูุจูุงูุงุช ุงูุฃุฎุฑู

ุชุชุถูู ูุงุฌูุฉ VBT ููุงุจุถ ุนุงูููุฉ ุฃุฎุฑูุ ูุซู **PinListData**ุ **DSPWave**ุ **RtaDataObj (ูุงุฆู ุจูุงูุงุช ุงูุชุนุฏูู ุงูุฒููู ููุชุดุบูู)** ูุบูุฑูุง. ุณูุณุชูุดููุง ูู ููุงูุงุช ูุณุชูุจููุฉ.

## ุงููุตูู ุจูุงุณุทุฉ ุงูุฃุฏุงุฉ ุฃู ุงูุฏุจูุณ

ุชุฏุนู ุจูุงุก ุฌูู VBT ุงููุตูู ุฅูู ุนุชุงุฏ ุงูุงุฎุชุจุงุฑ **ุจูุงุณุทุฉ ุงูุฃุฏุงุฉ** ุฃู **ุจูุงุณุทุฉ ุงูุฏุจูุณ**ุ ูููุง ูุชูุงูุฆุงู ูู ุงููุชูุฌุฉ. ูููุง ููู ุฃูุซูุฉ ุนูู ุงุณุชุฎุฏุงููุง:

```vbscript
' ุงููุตูู ุจูุงุณุทุฉ ุงูุฃุฏุงุฉุ ูุทุจู ุฃุฏุงุฉ ูุงุญุฏุฉ ุนูู ุฏุจุงุจูุณ ูุฎุชููุฉ
With TheHdw.instrument
    .Pins("Vcc").CurrentLimit = 0.75
    .Pins("Vee").ForceValue = 3.2
End With
```

```vbscript
' ุงููุตูู ุจูุงุณุทุฉ ุงูุฏุจูุณุ ูุญุฏุฏ ูุงุฆูุฉ ุฏุจุงุจูุณ ุซู ูุณุชุฎุฏู ุฃุฏูุงุช ูุฎุชููุฉ
With TheHdw.Pins("Vcc,Vdd,Vee")
    .instrument1.Disconnect
    .instrument2.CurrentLimit = 0.75
End With
```

## ุจููุฉ ููุฏ VBT

ูุฌุจ ุฃู ูููู ุงุณู ููู VBT ุจุชุณููุฉ `VBT_xxx`ุ ููุฌุจ ุฃู ูููู ุงูุงุณู ูุฑูุฏูุง.

ูุชููุน ุฃู ูููู **ูููุฉ ุงูุฅุฑุฌุงุน** ูุฏุงูุฉ VBT ูู 0 ุจุดูู ุงูุชุฑุงุถูุ ุฃู ูุฏ ุชุชุณุจุจ ูู ูุชุงุฆุฌ ุบูุฑ ูุชููุนุฉ.

ุจุงููุณุจุฉ ูููุนููุงุช ุงููุชุนููุฉ ุจู **ุงูุชูููุช** ู **ุงููุณุชููุงุช** ุ ููููู ุฅุถุงูุชูุง ูู ูุญุฑุฑ ุงููููุฐุฌ ุฃู ูุฑูุฉ ุงูุงุฎุชุจุงุฑ ุงูููุฑู ุ ููุง ููุฒู ุชุถููููุง ูู ูุธููุฉ VBT. ูููููู ุงูุชุญูู ูู ุชูููููุง ูู ูุธููุฉ VBT ุจุงุณุชุฎุฏุงู ุงูุงุณุชุฎุฏุงู ุงูุชุงูู:

```vbscript
TheHdw.Digital.ApplyLevelsTiming
```

ุจุงููุณุจุฉ ูู **ุญุฏูุฏ ุงูุงุฎุชุจุงุฑ** ุ ููููู ุงุณุชุฎุฏุงู ุงูููุฏ ุงูุชุงูู:

```vbscript
TheExec.Flow.TestLimit
```

ูููุงุฑูุฉ ูููุฉ ุงููุชูุฌุฉ ูุน ุงูุญุฏูุฏ ุงูููุฎูุถุฉ / ุงูุนุงููุฉ ุ ูุฅุฑุณุงู ูุชูุฌุฉ ุงูุงุฎุชุจุงุฑ (`TL_SUCCESS` / `TL_ERROR`) ูุบูุฑูุง ูู ุงููุนูููุงุช ุฅูู ุฏูุชุฑ ุงูุณุฌูุงุช.

ูุฑุคูุฉ **ุงููููู ุงูุฃุณุงุณู** ููุธููุฉ ุงุฎุชุจุงุฑ VBT ุจูุถูุญ ุ ููุงู ุนููุฉ:

```vbscript
Public Function VBTLeakTest(Pins As PinList, ForceVoltage As Double, PrePattern As PatternSet) As Long
    On Error GoTo errHandler

    Dim measure_results As New PinListData

    ' Set up timing and levels for Preconditioning Pattern
    TheHdw.Digital.ApplyLevelsTiming ConnectAllPins:=True, loadLevels:=True, loadTiming:=True, relaymode:=tlPowered

    ' Run Preconditioning Pattern and test for Pass/Fail
    TheHdw.Patterns(PrePattern).test pfAlways, 0

    ' Force V, Measure I
    With TheHdw.DCVI.Pins(Pins)
        .Mode = tlDCVIModeVoltage
            ... ' Addition code
        measure_results = .Meter.Read
    End With

    ' Test using limits in flow and write datalog
    Call TheExec.Flow.TestLimit(resultval:=measure_results, unit:=unitAmp, forceval:=ForceVoltage, forceunit:=unitVolt, ForceResults:=tlForceFlow)

    ' Reset the variable
    measure_results = Nothing

    Exit Function
errHandler:
    If AbortTest Then Exit Function Else Resume Next
End Function
```

## ูููุน ูุชุนุฏุฏ

๐ง

## ุนูููุงุช PinList

๐ง

## ูุตุงุฆุญ ูู VBA

- ุชุฌูุจ ุญูุธ ุงูุดูุฑุฉ ูู VBA ุ ูุฃู ูุฐุง ุณูุฎูู ุฑูุงุจุท ุฏุงุฎููุฉ ุตุนุจุฉ ูู ุฏูุชุฑ ุงูุนูู. ุจุฏูุงู ูู ุฐูู ุ ูุฌุจ ุญูุธูุง ูู ูุงุฌูุฉ DataTool.
- ุฅุฐุง ูุงุฌูุช ุฎุทุฃ "ุงูุฅุฌุฑุงุก ูุจูุฑ ุฌุฏูุง" ุ ููุฏ ุชููู ุถุฏ ูููุฏ Excel ุงูุจุงูุบุฉ 64 ูููู ุจุงูุช ููู ููู vb. ูููู ูู ุงููุงูุน ุ ูู ุงููููู ุฃูู ูุณูุช ุชุญููู ุงูุฅุตุฏุงุฑ ูู 32 ุจุช ุฅูู 64 ุจุช ูู ูุธุงู Windows.

> ุชูุช ุชุฑุฌูุฉ ูุฐู ุงููุดุงุฑูุฉ ุจุงุณุชุฎุฏุงู ChatGPTุ ูุฑุฌู [**ุชุฒููุฏูุง ุจุชุนูููุงุชูู**](https://github.com/linyuxuanlin/Wiki_MkDocs/issues/new) ุฅุฐุง ูุงูุช ููุงู ุฃู ุญุฐู ุฃู ุฅููุงู.