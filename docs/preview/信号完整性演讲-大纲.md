# Hello

欢迎大家今天来听我的分享。我今天分享的主题是信号完整性，我会讲一些基本概念，和几种常见的信号完整性问题。广义的信号完整性，其实涵盖了信号和电源完整性，还有电磁兼容性 EMC，我们今天只简单介绍狭义的信号完整性问题。我掌握的知识还不是很深，如果有讲得不好的地方也请大家帮忙指出来。

# END

信号完整性的问题更多出现在 PCB 设计中，在 ATE 调试中比较少遇到，但如果遇到了类似的问题，可以为我们提供多一种解决问题的思路。

[nderstanding Signal Integrity](https://www.youtube.com/watch?v=anX8QZMhVjI&list=PLxaBD9eBZcGTZaMZ-3HN5zXFQ06FDOjzJ&index=10&t=1s)

# About signals

我们知道，信号完整性指的是信号在传输线上的质量。我们通常用 0 和 1 表示信号，就是像图上画的，电压比这条线高就定义为逻辑 1，比这条线低就定义为逻辑 0。但信号本身是个模拟量，真实世界的数字电平 0 和 1 并不是理想的。

然后，信号传输的链条通常包括三部分：驱动器？，信号互连和接收器？

# Requirements for good data transmission

大多数情况下，信号是方波的形式，这些方波实际上是由多个频率分量的正弦波组成的。叠加的谐波次数越多，方波就会越方。

所以，好的数字数据传输通常需要保证两个因素，一是构成方波的所有频率分量都应经历相同的幅度变化，就是说应该被放大或衰减相同的倍数。二是所有频率分量的相位应该保持一致。

如果保证不了，就有可能会出现信号失真。

# Signal integrity

因此，信号完整性良好的表现，可以表示为传输线上的信号能按预期、不多不少地达到预设值。也可以说能够在接收器上准确地重建波形。

所有传输系统都会带来不一样的损耗？

在低速电路中，信号完整性问题并不明显，因为互连线对于电信号来说是通畅透明的；但如果往高速走，信号变化的速率变快，上升时间短，数字电平的电压或电流波形就会开始出现畸变，从而导致接收的信息与发出的信息差别太大，出现错误。所以，在高速电路中需要考虑到信号完整性的问题。

对高速信号我们没有严格的定义，一般来说，上升周期小于 1 纳秒的信号可以称为高速信号。

由此可见，信号完整性在高速电路设计中很重要。

# Channel

在理想互连中，信号在从发射器传输到接收器时可能会衰减或放大，也可能会有延迟，但接收信号仍然具有与发射信号基本相同的形状。

但在实际互连中，信号分量频率的相关变化会导致接收信号形状发生变化，这会使接收器更难正确检测传输信号电平或确定其状态。通常来说，高频率分量的信号会比低频率的衰减越多。

信号互连的另一种说法叫传输线，它是一种理想元件，由任意两条一定长度的导线组成，分别称为 **信号路径** 和 **返回路径（参考路径）**（图）观察信号的传输，需要同时看信号路径与返回路径。那怎么去分辨它们呢？一般来说，如果是微带线，会指定平面为返回路径便于分析；但如果两根线是一模一样的（比如双绞线），那就没有严格的区分。在信号完整性的范畴里，我们要尽量接地的概念，而是说返回路径，因为实际情况比接地要复杂。我们来看看实际情况。

我们一般用信号和返回路径之间的电压差表示信号，大家可能会觉得，信号传输的方式，是从信号路径出去，走到头再从返回路径回来，但实际上当信号刚开始进入信号路径时，在返回路径上就已经开始检测到电流了。但实际上信号是这样传输的 ：（gif）

信号互连大致分为 PCB 走线，连接器，或者外部线缆这三种形式。信号完整性的原理在所有的形式上都是通用的，我们会重点分析 PCB 走线上的信号完整性。

# Signal integrity issue

狭义的信号完整性问题分为两大类：

- 单一网络的信号失真
  - 阻抗不匹配导致的反射
  - 频率相关损耗造成互连线中的上升沿退化，出现信号质量问题
  - 时序错误（互连线电气特性差异、或长度差异引起的多个信号之间的时延差错位，会导致差分信号失真）
  - 噪声
- 两个或多个网络之间的串扰

# Reflection

反射产生的根本原因，是 **信号前进方向的瞬时阻抗发生改变**。有可能造成阻抗发生改变的源头：

- 走线改变方向/宽度，也比如走线分叉
- 断头线，所有的信号都会反射回去
- 通孔或过孔
- 信号不连续，例如走到器件管脚上

反射的来源有两种，阻抗突变处的反射和阻性负载的反射

---

如果沿着传输线走，任一位置横截面都相同，就称为均匀传输线，例如双绞线。这种传输线的阻抗是可控的。

为了最大限度地减少信号退化，信号应该沿路径或迹线看到恒定的阻抗。阻抗是一个点概念，因此不能保证走线中间的阻抗与走线开始或结束时的阻抗相同。

如果在任何一点存在阻抗不匹配或变化，这可能会导致反射，进而导致信号失真。

在 PCB 上有各种造成信号不匹配的因素：

- 走线改变方向/宽度，也比如走线分叉
- 断头线，所有的信号都会反射回去
- 通孔或过孔
- 信号不连续，例如走到器件管脚上
- 板材间的差异（不写）

# Frequency response / attenuation

信号也可能会因为特定的频率衰减而失真。假如说各频率衰减是均匀的，那么最终的信号形状也不会变，但实际上衰减会因信号频率提高而增大，所以会发生失真现象。

频率相关的损耗，主要来源是导体本身的电阻。另外 pcb 材料本身的特性也会在不同的频率下产生不同的介电损耗

另一种损耗的形式是趋肤效应。就是？高频率电流在导体内分布不均匀，更趋向于导体的边缘。这种效应这反过来会产生随频率增加的自感，并导致额外的衰减。

增加走线的宽度以增加其总表面积可以减少趋肤效应造成的损耗，但改变走线形态也有可能产生阻抗不匹配的问题，这就需要在各种影响因素中做出妥协了。

# Crosstalk（动画）

串扰是指相邻导体或迹线之间的能量耦合？

通常我们分别称两条互连线为影响的和被影响的。

分为近端串扰和远端。

减小串扰的方法是：

- 增加走线间隔
- 尽量避免平行走线
- 靠近地平面

# Noise

噪声大多是由电源引起的，关乎到电源完整性的问题。

抖动可以定义为信号时序的变化
